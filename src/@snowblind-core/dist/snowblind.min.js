var e={d:(t,n)=>{for(var s in n)e.o(n,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:n[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};e.d(t,{y$:()=>n,KS:()=>y,Ax:()=>o,tz:()=>s,MI:()=>c,oj:()=>r,Jj:()=>v,dy:()=>O,d4:()=>b,sO:()=>p,eJ:()=>f});class n{constructor(e){this._value=e,this._subscribers=[]}next(e){this._value=e;for(const t of this._subscribers)t(e)}subscribe(e){this._subscribers.push(e)}complete(){this._subscribers=new Proxy([],{set:()=>{throw new Error("Observable has been completed.")}})}restore(){this._subscribers=[],this._value=void 0}}class s{constructor(){this.current}}class r{constructor(e){this.observable=e,this.value=e._value,e.subscribe((e=>{this.value=e}))}valueOf(){return this.value}toString(){return this.value.toString()}}class o{constructor(e){this.ID=(Math.random()+1).toString(36).substring(2),i[this.ID]=this,this.setElement(e)}setElement(e){this.element=e,this.element.setAttribute&&this.element.setAttribute("data-is-snowblind-child",this.ID)}}const i={},a={},c=new n;class l{constructor(e,t={}){if(e._Observer.boundRender=this,this._wasDestroyed=!1,this._renderIsFirstTime=!0,this._maxCopies=e._maxCopies,this._copiesKeptAlive=0,this._lastNode=t.replace||document.body.appendChild(document.createElement("i")),this._Node,this.Object=e,!(e instanceof y.Component))throw new Error("Renderer didn't receive object of type Snowblind.Component")}Render(){if(this._wasDestroyed)throw new Error("Renderer has been destroyed.");if(this.Object._usesTransition){const e=this._Node;this._copiesKeptAlive>=this._maxCopies?e.remove():this.Object.transitionFunction.leave((()=>{e.remove(),this._copiesKeptAlive-=1}))}var e=this.Object.render();if(!(e instanceof HTMLElement))throw new Error("Can only initialize object with type of HTMLElement.");this._Node=e,this.Object.Node=this._Node;var t=this._Node;const n=document.activeElement,s=n.selectionStart,r=n.selectionEnd;let o;if((o=this._lastNode.getAttribute("data-is-snowblind-child"))&&i[o].setElement(this._Node),this._lastNode.replaceWith(this._Node),n){const e=n.getAttribute("key");if(e){const n=t.querySelector(`[key='${e}']`);n.focus(),n.setSelectionRange(s,r)}}if(this._lastNode=t,this.Object._usesTransition&&(this._copiesKeptAlive++,this.Object.transitionFunction.from((()=>{this._renderIsFirstTime||this.Object.transitionFunction.render()}))),this.Object.hasTheme){const e=document.createElement("div"),n=(e,t)=>{const n=this.Object.hasTheme[t];for(const s of Array.from(e))if("object"==typeof n)for(const e in n)s.style[e]=n[e];else s.style[t]=n};for(const s in this.Object.hasTheme){const r=t.querySelectorAll(s);r&&r.length>0?n(r,s):void 0!==e.style[s]&&n(Array.from(t.getElementsByTagName("*")).concat([t]),s)}}!0===this._renderIsFirstTime?(h(this.Object.didMountCallbacks,this._Node),this._renderIsFirstTime=!1):h(this.Object.didUpdateCallbacks,this._Node)}reinitialize(){this._renderIsFirstTime=!0,this.constructor(this.Object)}Destroy(){this._wasDestroyed=!0,h(this.Object.willUnmountCallbacks),this.Object._usesTransition?this.Object.transitionFunction.leave((()=>{this._Node.remove()})):this._Node.remove()}}const h=(e,...t)=>e.map((e=>e(...t))),d=Symbol("");class u{constructor(e,t=(()=>{})){const n={get(e,t){if(t===d)return!0;const s=e[t];if(void 0!==s){if(null!==s){var r=s.constructor;s[d]||!r||r!=={}.constructor&&r!==[].constructor||(e[t]=new Proxy(s,n))}return e[t]}},set:(e,n,s)=>(e[n]=s,this.boundRender&&(this.debounce&&window.cancelAnimationFrame(this.debounce),this.debounce=window.requestAnimationFrame((()=>{this.boundRender.Render()}))),t(e,n,s),!0)};this._value=new Proxy(e,n)}}function f(e,t=!0){const s=new n(e);var o=new r(s);return!0===t&&c.subscribe((e=>{const t=e.Renderer;s.subscribe((()=>{t.Render()}))})),[o,e=>("function"==typeof e&&(e=e()),e=e.valueOf(),s.next(e),e)]}const m=function e(t,n){if(t===n)return!0;if(!(t instanceof Object&&n instanceof Object))return!1;if(t.constructor!==n.constructor)return!1;for(var s in t)if(t.hasOwnProperty(s)){if(!n.hasOwnProperty(s))return!1;if(t[s]!==n[s]){if("object"!=typeof t[s])return!1;if(!e(t[s],n[s]))return!1}}for(s in n)if(n.hasOwnProperty(s)&&!t.hasOwnProperty(s))return!1;return!0};function b(e,t=[]){var n=t.map((e=>e.valueOf()));c.subscribe((s=>{const r=s=>{n.length>0?(n.filter(((e,n)=>!m(e,t[n].valueOf()))).length>0||0==n.length)&&(e(s),n=t.map((e=>e.valueOf()))):e(s)};s.onComponentDidMount(r),s.onComponentDidUpdate(r)}))}function p(){return new s}function v(e,t=[]){t=Array.from([t]).flat();for(const s in e){const r=e[s];var n=(void 0===t[0]?s:t[0]).toLowerCase();a[n]=r}}const y={Component:class{constructor(e,t,n={hasTheme:!1,replace:void 0}){const s=a[t.name.toLowerCase()];if(s){const t=s.propTypes;t&&window.typeCheck&&(e=window.typeCheck(e,t,s.defaultProps))}this.hasTheme=n.hasTheme,this._maxCopies=1/0,this._usesTransition=!1,this.didMountCallbacks=[],this.didUpdateCallbacks=[],this.willUnmountCallbacks=[],n.replace instanceof HTMLElement&&(e.children=Array.from(n.replace.childNodes).map((e=>new o(e)))),this._Observer=new u(e||{}),this.props=this._Observer._value,this.Renderer=new l(this,n);const r=n.replace.isReferenceTo;this._generatorFunction=t(e,r),c.next(this),c.restore(),this.Renderer.Render()}onComponentDidMount(e){this.didMountCallbacks.push(e)}onComponentDidUpdate(e){this.didUpdateCallbacks.push(e)}onComponentWillUnmount(e){this.willUnmountCallbacks.push(e)}render(...e){return this._generatorFunction()}},createContext(e){if("object"!=typeof e)throw new TypeError("`createContext` may only be used with objects.");const t=new n(e);return[new u(e,(e=>{t.next(e)}))._value,t]},renderAllIn(e=document.body){const t=e=>{for(const n of e){if(n instanceof HTMLScriptElement)continue;let e=n.nodeName.toLowerCase();if(a.hasOwnProperty(e)){let t=a[e];if("function"==typeof t){const e=this.getNodeProperties(n);new y.Component(e,t,{hasTheme:!1,replace:n})}}else t(Array.from(n.children))}};t(Array.from(e.children))},getNodeProperties:e=>Object.fromEntries(Array.from(e.attributes).map((e=>[e.name,e.value]))),eventBus:{on(e,t){document.addEventListener(e,(e=>t(e instanceof CustomEvent?e.detail:void 0)))},dispatch(e,t){document.dispatchEvent(new CustomEvent(e,{detail:t}))},remove(e,t){document.removeEventListener(e,t)}},createElement:(e,t,n=[])=>{let s=document.createElement(e);for(let e in t)if(Object.hasOwnProperty.call(t,e)){let n=t[e];if(null!=n)if("text"==e)s.innerText=n;else{let t=e.substring(1).replace("@","");if("@"===e[0])s.addEventListener(e,(t=>{"@"==e[1]&&t.target.isEqualNode(s),n(s,t)}));else if("."===e[0])s[t]=n;else if("?"===e[0])n&&s.setAttribute(t,n);else if("object"==typeof n)for(const e in n)s.setAttribute(e,n[e]);else s.setAttribute(e,n)}}for(let e of n)"function"==typeof e||e instanceof HTMLElement&&s.appendChild(e);return s}};window.addEventListener("load",(()=>{y.renderAllIn()}));const w=/\{\{([0-9]+)\}\}/g;class _{constructor(e,t){this.attributes=(e=>Array.from(e.attributes).map((e=>[e.name,e.value])).reduce(((e,t)=>(e[t[0]]=t[1],e)),{}))(e),this.node=e,this.values=t;let n=this.node.nodeName.toLowerCase();const s=a.hasOwnProperty(n);for(const e in this.attributes){let n,r=this.attributes[e],o=Array.from(r.matchAll(w)).map((e=>t[parseInt(e[1])])),i=e.substring(1),a=!1;n=-1===o.map((e=>"string"==typeof e)).indexOf(!1)?r.replace(w,((e,n)=>(n=parseInt(n),t[n]))):o[o.length-1],this.attributes[e]=n,!1===s&&("ref"===e&&(n.current=this.node,this.node.isReferenceTo=n,this.node.removeAttribute("ref")),e.startsWith("@")?"@"===e[1]?this.setEvent(i.substring(1),n,!0):this.setEvent(i,n,!1):e.startsWith(".")?this.setProperties(i,n):e.startsWith("?")?this.setConditionally(i,n):e.startsWith("!")?this.setObject(n):(this.trySetAttribute(e,n),a=!0),a||this.node.removeAttribute(e))}if(!0===s){let e=new y.Component(this.attributes,a[n],{hasTheme:!1,replace:this.node});this.node=e.Node}}trySetAttribute(e,t){try{this.node.setAttribute(e,t)}catch(t){console.error(`'${e}' is not a valid attribute name.`)}}setObject(e){for(const t in e){let n=e[t];this.trySetAttribute(t,n)}}setConditionally(e,t){t&&(this.node[e]=t)}setProperties(e,t){this.node[e]=t}setEvent(e,t,n=!1){this.node.addEventListener(e,(e=>{n&&e.target.isEqualNode(this.node)?t(this.node,e):n||t(this.node,e)}))}}function O(e,...t){function n(e,t){var n=document.createTextNode(t);e.appendChild(n)}var s="",i=0;for(const t of e)s+=t+(e[e.length-1]===t?"":`{{${i++}}}`);const a=document.createElement("template");if(a.innerHTML=s,a.content.children.length>1)throw new Error("Multiple elements must be wrapped in a single element.");const c=document.createTreeWalker(a.content,1,null);let l,h=0;for(;null!==(l=c.nextNode());){const e=new _(l,t);l=e.node,(l instanceof HTMLTextAreaElement||l instanceof HTMLInputElement)&&(l.hasAttribute("key")||(l.setAttribute("key","input-"+h),h++));var d=Array.from(l.childNodes);for(const e of d)if(e.nodeType===Node.TEXT_NODE){var u=e.textContent;const s=Array.from(u.matchAll(w));u=u.replace(w,(e=>" ".repeat(e.length))),s.length>0&&(e.textContent="");var f=0;for(let i=0;i<s.length;i++){const a=s[i];var m=t[parseInt(a[1])],b=u.substring(f,a.index);""!==b&&n(l,b);const c=t=>{var s,i;t instanceof o?c(t.element):t instanceof HTMLElement||t instanceof SVGElement||t instanceof Text?(s=t,(i=e)&&i.parentNode&&i.parentNode.insertBefore(s,i.nextSibling)):Array.isArray(t)?t.slice().reverse().map((e=>c(e))):t!==Object(t)||t instanceof r?n(l,t):console.error("Only instances of HTMLElement, SVGElement, Text, Array or SnowblindChild are supported.")};if(c(m),i==s.length-1){e.remove();var p=u.substring(a.index+a[0].length);""!=p&&n(l,p)}f=a.index+m&&m.length}}}const v=a.content.children[0];return y.renderAllIn(v),v}var E=t.y$,A=t.KS,C=t.Ax,T=t.tz,g=t.MI,j=t.oj,N=t.Jj,x=t.dy,S=t.d4,L=t.sO,M=t.eJ;export{E as Observable,A as Snowblind,C as SnowblindChild,T as SnowblindRef,g as UpdateDispatcher,j as ValueBinder,N as expose,x as html,S as useEffect,L as useRef,M as useState};