var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};e.d(t,{Z:()=>m});class n{constructor(e){this.observable=e,this.value=e._value,e.subscribe((e=>{this.value=e}))}valueOf(){return this.value}toString(){return this.value.toString()}}class r{constructor(e){this.ID=(Math.random()+1).toString(36).substring(2),s[this.ID]=this,this.setElement(e)}setElement(e){this.element=e,this.element.setAttribute&&this.element.setAttribute("data-is-snowblind-child",this.ID)}}const s={},o={},i=new class{constructor(e){this._value=e,this._subscribers=[]}next(e){this._value=e;for(const t of this._subscribers)t(e)}subscribe(e){this._subscribers.push(e)}complete(){this._subscribers=new Proxy([],{set:()=>{throw new Error("Observable has been completed.")}})}restore(){this._subscribers=[],this._value=void 0}};class a{constructor(e,t={}){if(e._Observer.boundRender=this,this._wasDestroyed=!1,this._renderIsFirstTime=!0,this._maxCopies=e._maxCopies,this._copiesKeptAlive=0,this._lastNode=t.replace||document.body.appendChild(document.createElement("i")),this._Node,this.Object=e,!(e instanceof p.Component))throw new Error("Renderer didn't receive object of type Snowblind.Component")}Render(){if(this._wasDestroyed)throw new Error("Renderer has been destroyed.");if(this.Object._usesTransition){const e=this._Node;this._copiesKeptAlive>=this._maxCopies?e.remove():this.Object.transitionFunction.leave((()=>{e.remove(),this._copiesKeptAlive-=1}))}var e=this.Object.render();if(!(e instanceof HTMLElement))throw new Error("Can only initialize object with type of HTMLElement.");this._Node=e,this.Object.Node=this._Node;var t=this._Node;const n=document.activeElement,r=n.selectionStart,o=n.selectionEnd;let i;if((i=this._lastNode.getAttribute("data-is-snowblind-child"))&&s[i].setElement(this._Node),this._lastNode.replaceWith(this._Node),n){const e=n.getAttribute("key");if(e){const n=t.querySelector(`[key='${e}']`);n.focus(),n.setSelectionRange(r,o)}}if(this._lastNode=t,this.Object._usesTransition&&(this._copiesKeptAlive++,this.Object.transitionFunction.from((()=>{this._renderIsFirstTime||this.Object.transitionFunction.render()}))),this.Object.hasTheme){const e=document.createElement("div"),n=(e,t)=>{const n=this.Object.hasTheme[t];for(const r of Array.from(e))if("object"==typeof n)for(const e in n)r.style[e]=n[e];else r.style[t]=n};for(const r in this.Object.hasTheme){const s=t.querySelectorAll(r);s&&s.length>0?n(s,r):void 0!==e.style[r]&&n(Array.from(t.getElementsByTagName("*")).concat([t]),r)}}!0===this._renderIsFirstTime?(c(this.Object.didMountCallbacks,this._Node),this._renderIsFirstTime=!1):c(this.Object.didUpdateCallbacks,this._Node)}reinitialize(){this._renderIsFirstTime=!0,this.constructor(this.Object)}Destroy(){this._wasDestroyed=!0,c(this.Object.willUnmountCallbacks),this.Object._usesTransition?this.Object.transitionFunction.leave((()=>{this._Node.remove()})):this._Node.remove()}}const c=(e,...t)=>e.map((e=>e(...t))),l=Symbol("");class f{constructor(e){this.boundRender=!1;const t={get(e,n){if(n===l)return!0;const r=e[n];if(void 0!==r){if(null!==r){var s=r.constructor;r[l]||!s||s!=={}.constructor&&s!==[].constructor||(e[n]=new Proxy(r,t))}return e[n]}},set:(e,t,n)=>(e[t]=n,this.boundRender&&(this.debounce&&window.cancelAnimationFrame(this.debounce),this.debounce=window.requestAnimationFrame((()=>{this.boundRender.Render()}))),!0)};this._value=new Proxy(e,t)}}const u=new Proxy({Number:e=>"number"==typeof e,Integer:e=>"number"==typeof e&&e%1==0,BigInt:e=>"bigint"==typeof e,Float:e=>"number"==typeof e&&e%1!=0,String:e=>"string"==typeof e,Array:e=>Array.isArray(e),Object:e=>"object"==typeof e&&!Array.isArray(e),Symbol:e=>"symbol"==typeof e,Boolean:e=>"boolean"==typeof e,Function:e=>"function"==typeof e,node:e=>["number","string"].indexOf(typeof e)>-1||e instanceof HTMLElement||Array.isArray(e),element:e=>e instanceof HTMLElement,elementType:e=>e instanceof(void 0).Component,instanceOf:function(e){return t=>t instanceof e},typeOf:function(e){return t=>typeof t===e},oneOfType:function(e){return t=>e.map((e=>"function"==typeof e?e(t):this[e](t))).indexOf(!0)>-1},oneOf:function(e){return t=>e.indexOf(t)>-1},arrayOf:function(e){return t=>!!this.Array.isArray(t)&&-1===t.map((n=>{"function"==typeof e?e(t):this[e](t)})).indexOf(!1)},objectOf:function(e){return t=>!!t&&this.arrayOf(e)(Object.values(t))},shape:function(e){return t=>this.exact(e,!0)(t)},exact:function(e,t=!1){return n=>{if(!n||!e)return!1;for(const s in n)if(e.hasOwnProperty(s)){var r=("string"==typeof e[s]?this[e[s]]:e[s])(n[s]);if(!1===r)return r}else if(!t)return!1}},customProp:e=>e,Any:()=>!0},{set:()=>!1,get:function(e,t){if(e.hasOwnProperty(t)){var n=e[t];return n.isRequired=function(n,r){if(void 0===n)throw new Error(`Encountered undefined prop "${r}" as required object.`);return e[t](n)},n.ofLength=function(n){return r=>e[t](r)&&r.length===n},n}throw new Error(`Invalid type for property "${t}" encountered.`)}}),h=function(e,t,n,r){r=Object.assign({returnBool:!1},r),e=Object.assign({},n,e);var s=[];if(void 0!==t)for(const n in t){const i=t[n];var o=("function"==typeof i?i:u[i]||(()=>!1))(e[n],n);if(!1===o){if(r.returnBool)return o;throw new Error(`Invalid type for property "${n}" encountered.`)}s.push(o)}return!(!r.returnBool||-1!==s.indexOf(!1))||e};HTMLElement.prototype.insertAfter=Text.prototype.insertAfter=function(e){e&&e.parentNode&&e.parentNode.insertBefore(this,e.nextSibling)},window.expose=function(e,t){e=Array.from([e]).flat(),t=Array.from([t]).flat();for(let r=0;r<e.length;r++){const s=e[r];var n=(void 0===t[r]?s.name:t[r]).toLowerCase();o[n]=s}};const d={Component:class{constructor(e,t,n={}){if(n=Object.assign({replace:!1,hasTheme:!1},n),this.createdReferences={},this.globalSelf=o[this.constructor.name.toLowerCase()],this.globalSelf){const t=this.globalSelf.propTypes;if(t){e=h(e,t,this.globalSelf.defaultProps),this.unexpectedArguments={};for(const n in e){var s=e[n];t.hasOwnProperty(n)||(this.unexpectedArguments[n]=s,delete e[n])}}}this.hasTheme=n.hasTheme,this._watchingObservers=[],this._maxCopies=1/0,this._usesTransition=!1,this.didMountCallbacks=[],this.didUpdateCallbacks=[],this.willUnmountCallbacks=[],n.replace instanceof HTMLElement&&(e.children=Array.from(n.replace.childNodes).map((e=>new r(e)))),this._Observer=new f(e||{}),this.props=this._Observer._value,this.Renderer=new a(this,n),this._generatorFunction=t(e),i.next(this),i.restore();for(const e of this._watchingObservers)e.boundRender=this.Renderer;this.Renderer.Render()}onComponentDidMount(e){this.didMountCallbacks.push(e)}onComponentDidUpdate(e){this.didUpdateCallbacks.push(e)}onComponentWillUnmount(e){this.willUnmountCallbacks.push(e)}render(...e){return this._generatorFunction()}},renderAllIn(e=document.body){const t=e=>{for(const n of e){if(n instanceof HTMLScriptElement)continue;let e=n.nodeName.toLowerCase();if(o.hasOwnProperty(e)){let t=o[e];if("function"==typeof t){const e=this.getNodeProperties(n);new d.Component(e,t,{replace:n})}}else t(Array.from(n.children))}};t(Array.from(e.children))},getNodeProperties:e=>Object.fromEntries(Array.from(e.attributes).map((e=>{var t=e.value,s=e.name;let o;if(o=t.match(/\{\{([A-z0-9_ ]*?)\}\}/)){var i=o[1].trim(),a=typeof window[i];"undefined"!==a&&"function"!==a?t=window[i]:"function"===a&&(t=i+i.endsWith("()")?"":"()")}else if(s.startsWith(":"))t=function(e,...t){function s(e,t,n,r){e.addEventListener(t,(t=>{r&&t.target.isEqualNode(e)?n(e,t):r||n(e,t)}))}function o(e,t){var n=document.createTextNode(t);e.appendChild(n)}const i=/\{\{([0-9]+)\}\}/g;var a="",c=0;for(const t of e)a+=t+(e[e.length-1]===t?"":`{{${c++}}}`);const l=document.createElement("template");if(l.innerHTML=a,l.content.children.length>1)throw new Error("Multiple elements must be wrapped in a single element.");const f=document.createTreeWalker(l.content,1,null);let u,h=0;for(;null!==(u=f.nextNode());){(u instanceof HTMLTextAreaElement||u instanceof HTMLInputElement)&&(u.hasAttribute("key")||(u.setAttribute("key","inputNo"+h),h++));for(const e of Array.from(u.attributes)){var d=e.name,m=e.nodeValue,b=d[0],y=d.substring(1);const r=/\{([@.?!]+)\}/;m=m.replace(i,((e,o)=>{var i=parseInt(o),a=t[i],c="";if("ref"===d&&a.constructor&&"SnowblindRef"===a.constructor.name)return a.current=u,u.isReferenceTo=a,void u.removeAttribute("ref");if("sx"===d){if("string"==typeof a)u.style=a;else if("object"==typeof a)for(const e in a)u.style[e]=a[e];return void u.removeAttribute("sx")}const l=d.match(r);var f=[];const h=e=>{let t=0;for(const n of f)!1!==e(n[0],n[1])?t++:(delete f[t],f=f.filter((e=>e)))},p=(e,t=!0)=>{"!"===e?((e=!1)=>{for(const t in a)e?f.push([t,a[t]]):u.setAttribute(t,a[t])})(t):"."===e?((e=!1)=>{e?h(((e,t)=>{u[e]=t})):u[y]=a})(t):"?"===e?((e=!1)=>{e?h(((e,t)=>{if(t instanceof n&&(t=t.valueOf()),!t)return!1})):(a instanceof n&&(a=a.valueOf()),a&&(u[y]=a))})(t):"@"===e?((e=!1)=>{if(e)h(((e,t)=>(s(u,e,t,!1),!1)));else{var t=!1;"@"===d[1]&&(t=!0,y=y.substring(1)),s(u,y,a,t)}})(t):c=a};if(l)for(const e of l[1])p(e,!0);else p(b,!1);return h(((e,t)=>{u.setAttribute(e,t)})),c})),-1!==["@",".","?","!"].indexOf(b)||d.match(r)?u.removeAttribute(d):"ref"!==d&&u.setAttribute(d,m)}var v=Array.from(u.childNodes);for(const e of v)if(e.nodeType===Node.TEXT_NODE){var g=e.wholeText;const s=Array.from(g.matchAll(i));g=g.replace(i,(e=>" ".repeat(e.length))),s.length>0&&(e.textContent="");var w=0;for(let i=0;i<s.length;i++){const a=s[i];var A=parseInt(a[1]),O=(m=t[A],g.substring(w,a.index));""!==O&&o(u,O);const c=t=>{if(t instanceof r)c(t.element);else if(t instanceof HTMLElement||t instanceof SVGElement||t instanceof Text)t.insertAfter(e);else if(t instanceof HTMLCollection||t instanceof NodeList){var s=document.createElement("span");s.insertAfter(e),s.replaceWith(...t)}else Array.isArray(t)?t.reverse().map((e=>c(e))):t!==Object(t)||t instanceof n?o(u,t):console.error("The value you passed as a variable is not yet supported.")};if(c(m),i==s.length-1){e.remove();var _=g.substring(a.index+a[0].length);""!=_&&o(u,_)}w=a.index+m&&m.length}}}const E=l.content.children[0];return p.renderAllIn(E),E}([t]),s=s.substring(1);else if(t.startsWith("{")&&t.endsWith("}")){var c=t.substring(1,t.length-1);"true"===c||"false"===c?t="true"===c:parseFloat(c)==c&&(t=parseFloat(c))}else t.startsWith("[")&&t.endsWith("]")&&(t=JSON.parse(t.replace(/(?<!\\)'/g,'"')));return[s.startsWith("_")?s.substring(1):s,t]}))),eventBus:{on(e,t){document.addEventListener(e,(e=>t(e.detail)))},dispatch(e,t){document.dispatchEvent(new CustomEvent(e,{detail:t}))},remove(e,t){document.removeEventListener(e,t)}},createElement:(e,t,n=[])=>{let r=document.createElement(e);for(let e in t)if(Object.hasOwnProperty.call(t,e)){let n=t[e];if(null!=n)if("text"==e)r.innerText=n;else{let t=e.substring(1).replace("@","");if("@"===e[0])r.addEventListener(e,(t=>{"@"==e[1]&&t.target.isEqualNode(r),n(r,t)}));else if("."===e[0])r[t]=n;else if("?"===e[0])n&&r.setAttribute(t,n);else if("object"==typeof n)for(const e in n)r.setAttribute(e,n[e]);else r.setAttribute(e,n)}}for(let e of n)"function"==typeof e||e instanceof HTMLElement&&r.appendChild(e);return r}};window.addEventListener("load",(()=>{d.renderAllIn()})),HTMLElement.prototype.insertAfter=function(e){e&&e.parentNode&&e.parentNode.insertBefore(this,e.nextSibling)};const p=d,m=p;var b=t.Z;export{b as default};