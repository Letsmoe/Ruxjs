var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};e.d(t,{Z:()=>u});class n{constructor(e){this.observable=e,this.value=e._value,e.subscribe((e=>{this.value=e}))}valueOf(){return this.value}toString(){return this.value.toString()}}const r=new class{constructor(e){this._value=e,this._subscribers=[]}_updateValue(e){this._value=e;for(const t of this._subscribers)t(e)}next(e){this._updateValue(e)}subscribe(e){this._subscribers.push(e)}complete(){this._subscribers=new Proxy([],{set:()=>{throw new Error("Observable has been completed.")}})}restore(){this._subscribers=[],this._value=void 0}};class o{constructor(e,t={}){console.log(t),e._Observer.boundRender=this,this._wasDestroyed=!1,this.copiesKeptAlive=0,this.lastNode,this.Node,this.ID=Math.random().toString(36).substring(2,15);var n=document.createElement("span");if(n.classList.add("render-placeholder"),n.setAttribute("render-is-linked-to",this.ID),t.replace instanceof HTMLElement?t.replace.replaceWith(n):document.body.appendChild(n),this.LinkedTo=n,this.Object=e,!(e instanceof l.Component))throw new Error("Renderer didn't receive object of type Snowblind.Component");this._renderIsFirstTime=!0}Render(){if(this._wasDestroyed)throw new Error("Renderer has been destroyed.");var e=this.Object.transitionMaxCopies;if(!1===this._renderIsFirstTime&&(this.Object.originalChildren=this.Node.childNodes),this.Object.usesTransition){const t=this.Node;this.copiesKeptAlive>=e?t.remove():this.Object.transitionFunction.leave((()=>{t.remove(),this.copiesKeptAlive-=1}))}this.Object.parentElement=this.LinkedTo.parentNode;var t=this.Object.getNode();if(!(t instanceof HTMLElement))throw new Error("Can only initialize object with type of HTMLElement.");this.Node=t,this.Object.Node=this.Node;var n=this.Node;if(this.lastNode){const e=document.activeElement,t=e.selectionStart,r=e.selectionEnd;if(this.lastNode.replaceWith(n),e){const o=e.getAttribute("key");if(o){const e=n.querySelector(`[key='${o}']`);e.focus(),e.setSelectionRange(t,r)}}}else this.LinkedTo.replaceWith(n);if(this.lastNode=n,this.Object.usesTransition&&(this.copiesKeptAlive++,this.Object.transitionFunction.from((()=>{this._renderIsFirstTime||this.Object.transitionFunction.render()}))),this.Object.hasTheme){const e=document.createElement("div"),t=(e,t)=>{const n=this.Object.hasTheme[t];for(const r of Array.from(e))if("object"==typeof n)for(const e in n)r.style[e]=n[e];else r.style[t]=n};for(const r in this.Object.hasTheme){const o=n.querySelectorAll(r);o&&o.length>0?t(o,r):void 0!==e.style[r]&&t(Array.from(n.getElementsByTagName("*")).concat([n]),r)}}if(!0===this._renderIsFirstTime){this.Object.componentDidMount();for(const e of this.Object.didMountCallbacks)e();this._renderIsFirstTime=!1}else{this.Object.componentDidUpdate();for(const e of this.Object.didUpdateCallbacks)e()}}reinitialize(){this._renderIsFirstTime=!0,this.constructor(this.Object)}Destroy(){this._wasDestroyed=!0,this.Object.componentWillUnmount(),this.Object.usesTransition?this.Object.transitionFunction.leave((()=>{this.Node.remove()})):this.Node.remove()}}class s{constructor(e,t=!1){this.ID=Math.random().toString(36).substring(2,15),this.boundRender=void 0;const n={get(e,t){if("__isProxy"==t)return!0;const r=e[t];if(void 0!==r){if(null!==r){var o=r.constructor;r.__isProxy||!o||o!=={}.constructor&&o!==[].constructor||(e[t]=new Proxy(r,n))}return e[t]}},set:(e,t,n)=>{try{e[t]=JSON.parse(n)}catch(r){e[t]=n}return this.boundRender&&(this.debounce&&window.cancelAnimationFrame(this.debounce),this.debounce=window.requestAnimationFrame((()=>{this.boundRender.Render()}))),!0}};this._value=new Proxy(e,n),!0===t&&(this._value.toString=()=>this._value.value)}}const i=new Proxy({Number:e=>"number"==typeof e,Integer:e=>"number"==typeof e&&e%1==0,BigInt:e=>"bigint"==typeof e,Float:e=>"number"==typeof e&&e%1!=0,String:e=>"string"==typeof e,Array:e=>Array.isArray(e),Object:e=>"object"==typeof e&&!Array.isArray(e),Symbol:e=>"symbol"==typeof e,Boolean:e=>"boolean"==typeof e,Function:e=>"function"==typeof e,node:e=>["number","string"].indexOf(typeof e)>-1||e instanceof HTMLElement||Array.isArray(e),element:e=>e instanceof HTMLElement,elementType:e=>e instanceof(void 0).Component,instanceOf:function(e){return t=>t instanceof e},typeOf:function(e){return t=>typeof t===e},oneOfType:function(e){return t=>e.map((e=>"function"==typeof e?e(t):this[e](t))).indexOf(!0)>-1},oneOf:function(e){return t=>e.indexOf(t)>-1},arrayOf:function(e){return t=>!!this.Array.isArray(t)&&-1===t.map((n=>{"function"==typeof e?e(t):this[e](t)})).indexOf(!1)},objectOf:function(e){return t=>!!t&&this.arrayOf(e)(Object.values(t))},shape:function(e){return t=>this.exact(e,!0)(t)},exact:function(e,t=!1){return n=>{if(!n||!e)return!1;for(const o in n)if(e.hasOwnProperty(o)){var r=("string"==typeof e[o]?this[e[o]]:e[o])(n[o]);if(!1===r)return r}else if(!t)return!1}},customProp:e=>e,Any:()=>!0},{set:()=>!1,get:function(e,t){if(e.hasOwnProperty(t)){var n=e[t];return n.isRequired=function(n,r){if(void 0===n)throw new Error(`Encountered undefined prop "${r}" as required object.`);return e[t](n)},n.ofLength=function(n){return r=>e[t](r)&&r.length===n},n}throw new Error(`Invalid type for property "${t}" encountered.`)}}),a=function(e,t,n,r){r=Object.assign({returnBool:!1},r),e=Object.assign({},n,e);var o=[];if(void 0!==t)for(const n in t){const a=t[n];var s=("function"==typeof a?a:i[a]||(()=>!1))(e[n],n);if(!1===s){if(r.returnBool)return s;throw new Error(`Invalid type for property "${n}" encountered.`)}o.push(s)}return!(!r.returnBool||-1!==o.indexOf(!1))||e};HTMLElement.prototype.insertAfter=function(e){e&&e.parentNode&&e.parentNode.insertBefore(this,e.nextSibling)},window.exposedComponents={};var c=document.createElement("style");c.innerHTML=".render-placeholder {display:none;}",document.head.appendChild(c),window.expose=function(e,t){e=Array.from([e]).flat(),t=Array.from([t]).flat();for(let r=0;r<e.length;r++){const o=e[r];var n=(void 0===t[r]?o.name:t[r]).toLowerCase();window.exposedComponents[n]=o}};const d={Component:class{constructor(e,t={}){if(t=Object.assign({replace:!1,isFunctionProps:{},hasTheme:!1},t),this.createdReferences={},this.globalSelf=window.exposedComponents[this.constructor.name.toLowerCase()],this.globalSelf){const t=this.globalSelf.propTypes;if(t){e=a(e,t,this.globalSelf.defaultProps),this.unexpectedArguments={};for(const r in e){var n=e[r];t.hasOwnProperty(r)||(this.unexpectedArguments[r]=n,delete e[r])}}}this.hasTheme=t.hasTheme,this._watchingObservers=[],this.transitionMaxCopies=1/0,this._isFunction="function"==typeof e,this.usesTransition=!1,this.didMountCallbacks=[],this.didUpdateCallbacks=[],this._isFunction&&(this._generatorFunction=e(t.isFunctionProps));var i=this.initWith();this._Observer=new s(e||i),this.props=this._Observer._value,t.replace instanceof HTMLElement&&(this.originalElement=t.replace,this.originalChildren=Array.from(t.replace.childNodes)),this.Renderer=new o(this,t),r.next(this),r.restore();for(const e of this._watchingObservers)e.boundRender=this.Renderer;this.__init__(),this.Renderer.Render()}useTransition(e,t){t=Object.assign({delay:0,duration:400,maxCopies:1/0,customTiming:(e,t,n,r)=>-n/2*(Math.cos(Math.PI*e/r)-1)+t},t),this.transitionMaxCopies=t.maxCopies,this.usesTransition=!0;const n=(e,n,r)=>new Promise((o=>{setTimeout((()=>{const s=performance.now(),i=new RegExp(/([0-9.-]+)([A-z%]+)?/g),a=e=>-1==[void 0,null].indexOf(e)&&e.toString().matchAll(i),c=(d=!1)=>{const l=performance.now()-s;l>=t.duration?(d||requestAnimationFrame((()=>{c(!0)})),o()):requestAnimationFrame((()=>{c()}));for(const o in n){var u=Array.from(a(n[o]));if(-1==[void 0,null].indexOf(e[o])){var h=0,f=e[o].toString().replace(i,((e,n,r)=>{n=parseFloat(n);var s=parseFloat(u[h][1]);h++;var i=-1===["color","background","background-color"].indexOf(o)?"px":"";return t.customTiming(l,n,s-n,t.duration).toString()+(r||u[h-1][2]||i)}));for(const e of r)e[0].style[o]=f,d&&(e[0].style[o]=n[o])}}};requestAnimationFrame((()=>{c()}))}),t.delay)}));this.transitionFunction={from:t=>{for(const t in e.from)this.Nodes.map((n=>n[0].style[t]=e.from[t]));t()},render:t=>{n(e.render,e.enter,this.Nodes).then(t)},enter:t=>{n(e.from,e.enter,this.Nodes).then(t)},leave:t=>{n(e.enter,e.leave,this.Nodes).then(t)}}}fadeOutDestroy(e=400){var t=performance.now();const n=()=>{var r=performance.now()-t;r>=e?this.destroy():(this.Nodes.map((t=>t[0].style.opacity=1-r/e)),requestAnimationFrame(n))};requestAnimationFrame(n)}onComponentDidMount(e){this.didMountCallbacks.push(e)}onComponentDidUpdate(e){this.didUpdateCallbacks.push(e)}componentDidUpdate(){}componentDidMount(){}componentWillUnmount(){}initWith(){return{}}destroy(){this.Renderer.Destroy();for(const e in this.createdReferences)delete this.createdReferences[e]}__init__(){}getNode(...e){if(this._isFunction)return this._generatorFunction();throw new Error("Could not render, are you sure you created the 'render' method according to our docs? https://continuum-ai.de/doc/snowblind/reference/render-assignment")}},renderAll(){const e=window.exposedComponents;for(const t in e){const n=e[t],r="function"==typeof n;if(n&&n.prototype instanceof d.Component||r){const n=Array.from(document.getElementsByTagName(t));for(const o of n){const n=d.getNodeProperties(o);r?new d.Component(e[t],{replace:o,isFunctionProps:n}):new e[t](n,{replace:o})}}}},getNodeProperties:e=>Object.fromEntries(Array.from(e.attributes).map((e=>{var t=e.value,r=e.name;let o;if(o=t.match(/\{\{([A-z0-9_ ]*?)\}\}/)){var s=o[1].trim(),i=typeof window[s];"undefined"!==i&&"function"!==i?t=window[s]:"function"===i&&(t=s+s.endsWith("()")?"":"()")}else if(r.startsWith(":"))t=function(e,...t){function r(e,t,n,r){e.addEventListener(t,(t=>{r&&t.target.isEqualNode(e)?n(e,t):r||n(e,t)}))}function o(e,t){var n=document.createTextNode(t);e.appendChild(n)}function s(e,t){return!!e.parentNode&&(e.tagName===t||s(e.parentNode,t))}const i=/\{\{([0-9]+)\}\}/g;var a="",c=0;for(const t of e)a+=t+(e[e.length-1]===t?"":`{{${c++}}}`);const d=document.createElement("template");if(d.innerHTML=a,d.content.children.length>1)throw new Error("Multiple elements must be wrapped in a single element.");const u=document.createTreeWalker(d.content,1,null);let h,f=0;for(;null!==(h=u.nextNode());){(h instanceof HTMLTextAreaElement||h instanceof HTMLInputElement)&&(h.hasAttribute("key")||(h.setAttribute("key","inputNo"+f),f++));for(const e of Array.from(h.attributes)){var p=e.name,m=e.nodeValue,v=p[0],b=p.substring(1);const o=/\{([@.?!]+)\}/;m=m.replace(i,((e,s)=>{var i=parseInt(s),a=t[i],c="";if("ref"===p&&a.constructor&&"SnowblindRef"===a.constructor.name)return a.current=h,h.isReferenceTo=a,void h.removeAttribute("ref");if("sx"===p){if("string"==typeof a)h.style=a;else if("object"==typeof a)for(const e in a)h.style[e]=a[e];return void h.removeAttribute("sx")}const d=p.match(o);var l=[];const u=e=>{let t=0;for(const n of l)!1!==e(n[0],n[1])?t++:(delete l[t],l=l.filter((e=>e)))},f=(e,t=!0)=>{"!"===e?((e=!1)=>{for(const t in a)e?l.push([t,a[t]]):h.setAttribute(t,a[t])})(t):"."===e?((e=!1)=>{e?u(((e,t)=>{h[e]=t})):h[b]=a})(t):"?"===e?((e=!1)=>{e?u(((e,t)=>{if(t instanceof n&&(t=t.valueOf()),!t)return!1})):(a instanceof n&&(a=a.valueOf()),a&&(h[b]=a))})(t):"@"===e?((e=!1)=>{if(e)u(((e,t)=>(r(h,e,t,!1),!1)));else{var t=!1;"@"===p[1]&&(t=!0,b=b.substring(1)),r(h,b,a,t)}})(t):c=a};if(d)for(const e of d[1])f(e,!0);else f(v,!1);return u(((e,t)=>{h.setAttribute(e,t)})),c})),-1!==["@",".","?","!"].indexOf(v)||p.match(o)?h.removeAttribute(p):"ref"!==p&&h.setAttribute(p,m)}var y=Array.from(h.childNodes);for(const e of y)if(e.nodeType===Node.TEXT_NODE){var g=e.wholeText;s(e,"PRE")||(g=g.trim());const r=Array.from(g.matchAll(i));g=g.replace(i,(e=>" ".repeat(e.length))),r.length>0&&(e.textContent="");var w=0;for(let s=0;s<r.length;s++){const i=r[s];var E=parseInt(i[1]),O=(m=t[E],g.substring(w,i.index));""!==O&&o(h,O);const a=t=>{if(t instanceof HTMLElement||t instanceof SVGElement||t instanceof Text)(r=document.createElement("span")).insertAfter(e),r.replaceWith(t);else if(t instanceof HTMLCollection||t instanceof NodeList){var r;(r=document.createElement("span")).insertAfter(e),r.replaceWith(...t)}else Array.isArray(t)?t.reverse().map((e=>a(e))):t!==Object(t)||t instanceof n?o(h,t):console.error("Value might not be supported...")};if(a(m),s==r.length-1){e.remove();var A=g.substring(i.index+i[0].length);""!=A&&o(h,A)}w=i.index+m&&m.length}}}y=Array.from(d.content.childNodes).map((e=>e.getElementsByTagName&&Array.from(e.getElementsByTagName("*")))).flat();for(const e of y){let t;e&&e.tagName&&(t=window.exposedComponents[e.tagName.toLowerCase()])&&new t(l.getNodeProperties(e),{replace:e,implementedEvents:e._savedEvents||[]})}return d.content.children[0]}([t]),r=r.substring(1);else if(t.startsWith("{")&&t.endsWith("}")){var a=t.substring(1,t.length-1);"true"===a||"false"===a?t="true"===a:parseFloat(a)==a&&(t=parseFloat(a))}else t.startsWith("[")&&t.endsWith("]")&&(t=JSON.parse(t.replace(/(?<!\\)'/g,'"')));return[r.startsWith("_")?r.substring(1):r,t]}))),eventBus:{on(e,t){document.addEventListener(e,(e=>t(e.detail)))},dispatch(e,t){document.dispatchEvent(new CustomEvent(e,{detail:t}))},remove(e,t){document.removeEventListener(e,t)}}};window.addEventListener("load",(()=>{d.renderAll()})),HTMLElement.prototype.insertAfter=function(e){e&&e.parentNode&&e.parentNode.insertBefore(this,e.nextSibling)},EventTarget.prototype.originalAddEvent=EventTarget.prototype.addEventListener,EventTarget.prototype.originalRemoveEvent=EventTarget.prototype.removeEventListener,EventTarget.prototype.addEventListener=function(...e){var t=e[0];this._savedEvents||(this._savedEvents={}),this._savedEvents[t]||(this._savedEvents[t]=[]),this._savedEvents[t].push(e),this.originalAddEvent(...e)},EventTarget.prototype.removeEventListener=function(...e){var t=e[0];if(e[1]&&this._savedEvents){var n=this._savedEvents[t];if(n)for(let r=0;r<n.length;r++)if(n[r][1]==e[1]){delete n[r],this._savedEvents[t]=n.filter((e=>e));break}}this.originalRemoveEvent(...e)};const l=d,u=l;var h=t.Z;export{h as default};